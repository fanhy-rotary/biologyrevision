<!DOCTYPE html>
<html lang="zh-HK">
  <head>
    <meta charset="UTF-8" />
    <title>ç”Ÿç‰©ç§‘å¤šé …é¸æ“‡é¡Œç·´ç¿’</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      :root {
        --primary: #2c7be5;
        --primary-light: #e5f0ff;
        --danger: #e55353;
        --success: #28a745;
        --bg: #f5f7fb;
        --card-bg: #ffffff;
        --text-main: #222222;
        --text-muted: #666666;
        --border: #e0e4ee;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        padding: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui,
          "PingFang TC", "Noto Sans TC", sans-serif;
        background-color: var(--bg);
        color: var(--text-main);
      }

      .app-container {
        max-width: 900px;
        margin: 0 auto;
        padding: 16px;
      }

      .app-title {
        text-align: center;
        margin: 12px 0 8px;
        font-size: 1.6rem;
        font-weight: 700;
      }

      .app-subtitle {
        text-align: center;
        font-size: 0.9rem;
        color: var(--text-muted);
        margin-bottom: 14px;
      }

      .card {
        background-color: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 6px 18px rgba(15, 35, 95, 0.08);
        padding: 18px 18px 16px;
      }

      .status-bar {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        gap: 8px;
        margin-bottom: 12px;
        font-size: 0.9rem;
        color: var(--text-muted);
      }

      .question-image {
        margin-bottom: 10px;
        text-align: center;
      }

      .question-image img {
        max-width: 100%;
        height: auto;
        border-radius: 6px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.12);
      }

      .question-text {
        font-size: 1rem;
        line-height: 1.5;
        margin-bottom: 10px;
        white-space: pre-wrap; /* æ”¯æ´ \n æ›è¡Œ */
      }

      .options-list {
        list-style: none;
        margin: 0;
        padding: 0;
      }

      .option-item {
        margin-bottom: 8px;
      }

      .option-label {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        padding: 10px 12px;
        border-radius: 8px;
        border: 1px solid var(--border);
        background-color: #ffffff;
        cursor: pointer;
        transition: background-color 0.15s ease, border-color 0.15s ease;
        font-size: 0.95rem;
      }

      .option-label:hover {
        border-color: var(--primary);
        background-color: var(--primary-light);
      }

      .option-label input[type="radio"] {
        margin-top: 3px;
      }

      .option-label.correct {
        border-color: var(--success);
        background-color: #e6f6eb;
      }

      .option-label.incorrect {
        border-color: var(--danger);
        background-color: #fdecec;
      }

      .feedback {
        margin-top: 10px;
        font-size: 0.95rem;
        min-height: 1.4em;
      }

      .feedback.correct {
        color: var(--success);
      }
      .feedback.incorrect {
        color: var(--danger);
      }

      .explanation {
        margin-top: 8px;
        padding: 8px 10px;
        border-radius: 8px;
        background-color: #f0f4ff;
        font-size: 0.9rem;
        color: #1d2b5b;
      }

      .button-row {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 16px;
        flex-wrap: wrap;
      }

      button {
        border-radius: 999px;
        border: none;
        padding: 8px 16px;
        font-size: 0.9rem;
        cursor: pointer;
        transition: background-color 0.15s ease;
        display: inline-flex;
        align-items: center;
        gap: 4px;
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .btn-primary {
        background-color: var(--primary);
        color: #ffffff;
        box-shadow: 0 3px 8px rgba(44, 123, 229, 0.3);
      }

      .btn-primary:hover:not(:disabled) {
        background-color: #1f62c2;
      }

      .btn-ghost {
        background-color: transparent;
        color: var(--primary);
        border: 1px solid var(--primary-light);
      }

      .btn-ghost:hover:not(:disabled) {
        background-color: var(--primary-light);
      }

      .summary-card {
        margin-top: 18px;
        padding: 18px;
        border-radius: 12px;
        background-color: var(--card-bg);
        box-shadow: 0 6px 18px rgba(15, 35, 95, 0.06);
      }

      .summary-title {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 6px;
      }

      .summary-main-score {
        font-size: 1.3rem;
        margin-bottom: 4px;
      }

      .summary-percent {
        font-size: 0.95rem;
        color: var(--text-muted);
        margin-bottom: 10px;
      }

      .wrong-list {
        font-size: 0.9rem;
        color: var(--text-muted);
      }

      .tag {
        display: inline-block;
        padding: 2px 8px;
        border-radius: 999px;
        background-color: #fff5e6;
        color: #cc7a00;
        font-size: 0.8rem;
        margin-right: 6px;
      }

      @media (max-width: 600px) {
        .app-container {
          padding: 10px;
        }
        .card {
          padding: 14px 12px 12px;
        }
        .button-row {
          flex-direction: column-reverse;
          align-items: stretch;
        }
        button {
          justify-content: center;
        }
        .app-title {
          font-size: 1.35rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <h1 class="app-title">ç”Ÿç‰©ç§‘å¤šé …é¸æ“‡é¡Œç·´ç¿’</h1>
      <div class="app-subtitle">é¦™æ¸¯ DSE ç”Ÿç‰©ï½œä¸€æ¬¡ä¸€é¡Œ</div>

      <div id="quiz-card" class="card">
        <div class="status-bar">
          <div><span id="progress-text">ç¬¬ 1 é¡Œï¼å…± 0 é¡Œ</span></div>
          <div><span id="score-text">ç›®å‰å¾—åˆ†ï¼š0ï¼0 é¡Œ</span></div>
        </div>

        <!-- é¡Œç›®åœ–ç‰‡ï¼ˆå¦‚æœ‰ï¼‰ -->
        <div id="question-image" class="question-image" style="display: none;"></div>

        <!-- é¡Œç›®æ–‡å­— -->
        <div id="question-text" class="question-text">é¡Œç›®è¼‰å…¥ä¸­â€¦â€¦</div>

        <!-- é¸é … -->
        <ul id="options-container" class="options-list"></ul>

        <div id="feedback" class="feedback"></div>
        <div id="explanation" class="explanation" style="display: none"></div>

        <div class="button-row">
          <button id="restart-btn" class="btn-ghost" type="button">
            ğŸ” é‡æ–°é–‹å§‹
          </button>
          <div style="flex: 1 0 auto"></div>
          <button id="submit-btn" class="btn-primary" type="button" disabled>
            âœ… æäº¤ç­”æ¡ˆ
          </button>
          <button id="next-btn" class="btn-primary" type="button" disabled>
            ä¸‹ä¸€é¡Œ âœ
          </button>
        </div>
      </div>

      <div id="summary-card" class="summary-card" style="display: none">
        <div class="summary-title">ç·´ç¿’çµæœ</div>
        <div id="summary-main" class="summary-main-score"></div>
        <div id="summary-percent" class="summary-percent"></div>
        <div class="wrong-list" id="wrong-list"></div>
      </div>
    </div>

    <script>
      // ========= é¡Œåº«ï¼ˆ14 é¡Œï¼ŒåŠ å…¥ image æ¬„ä½ï¼‰=========
      // æœ‰åœ–çš„é¡Œç›®æœƒå¤šä¸€å€‹ image å±¬æ€§ï¼Œå…¶é¤˜é¡Œç›®å¯çœç•¥ã€‚
      const questionBank = [
        {
          id: 1,
          question:
            "ä¸‹è¡¨åˆ—å‡ºäººé«”å…§ä¸‰ç¨®ä¸åŒé¡å‹ç´°èƒçš„æŸ“è‰²é«”æ•¸ç›®ï¼š\nPï¼š0\nQï¼š23\nRï¼š46\n\nä»¥ä¸‹å“ªé …çµ„åˆæ­£ç¢ºè­˜åˆ¥ç´°èƒé¡å‹ Pã€Q å’Œ Rï¼Ÿ",
          options: [
            "A. Pï¼šç¥ç¶“ç´°èƒï¼›Qï¼šç´…è¡€ç´°èƒï¼›Rï¼šç²¾å­",
            "B. Pï¼šç¥ç¶“ç´°èƒï¼›Qï¼šç²¾å­ï¼›Rï¼šç´…è¡€ç´°èƒ",
            "C. Pï¼šç´…è¡€ç´°èƒï¼›Qï¼šç¥ç¶“ç´°èƒï¼›Rï¼šç²¾å­",
            "D. Pï¼šç´…è¡€ç´°èƒï¼›Qï¼šç²¾å­ï¼›Rï¼šç¥ç¶“ç´°èƒ"
          ],
          answer: "D",
          explanation: ""
        },
        {
          id: 2,
          question:
            "æŸåµç´°èƒåœ¨ä¸€æ®µæ™‚é–“å…§ DNA çš„ç›¸å°å«é‡å‡ºç¾è®ŠåŒ–ï¼šåœ¨æ™‚é–“ X æ€¥å‡ï¼Œåœ¨æ™‚é–“ Y ç•¥ç‚ºä¸‹é™ã€‚ç´°èƒåœ¨æ™‚é–“ X å’Œ Y åˆ†åˆ¥é€²è¡Œç”šéº¼éç¨‹ï¼Ÿ",
          options: [
            "A. æ™‚é–“ Xï¼šDNA è¤‡è£½ï¼›æ™‚é–“ Yï¼šæœ‰çµ²ç´°èƒåˆ†è£‚",
            "B. æ™‚é–“ Xï¼šDNA è¤‡è£½ï¼›æ™‚é–“ Yï¼šæ¸›æ•¸ç´°èƒåˆ†è£‚",
            "C. æ™‚é–“ Xï¼šå—ç²¾ï¼›æ™‚é–“ Yï¼šæœ‰çµ²ç´°èƒåˆ†è£‚",
            "D. æ™‚é–“ Xï¼šå—ç²¾ï¼›æ™‚é–“ Yï¼šæ¸›æ•¸ç´°èƒåˆ†è£‚"
          ],
          answer: "C",
          image: "img_q2_dna.png",
          explanation: ""
        },
        {
          id: 3,
          question:
            "ä¸‹åˆ—å“ªä¸€é …ï¼ˆäº›ï¼‰å­˜åœ¨æ–¼çœŸæ ¸ç´°èƒå’ŒåŸæ ¸ç´°èƒï¼Ÿ\n(1) DNA\n(2) ç”±çº–ç¶­ç´ çµ„æˆçš„ç´°èƒå£\n(3) ç£·è„‚",
          options: [
            "A. åªæœ‰ (1)",
            "B. åªæœ‰ (1) å’Œ (3)",
            "C. åªæœ‰ (2) å’Œ (3)",
            "D. (1)ã€(2) å’Œ (3)"
          ],
          answer: "B",
          explanation: ""
        },
        {
          id: 4,
          question:
            "ä¸‰æ ªé«˜åº¦æ¥è¿‘ã€åŒæ¨£å¸¶æœ‰å››ç‰‡ç¶ è‘‰çš„å¹¼è‹—ï¼Œè¢«åˆ†åˆ¥ç½®æ–¼ä¸‰å€‹ç››æœ‰ä¸åŒåŸ¹é¤Šæ¶²çš„å®¹å™¨å…§ï¼Œä»¥æ¢ç©¶ä¸åŒç¤¦ç‰©è³ªå°å¹¼è‹—ç”Ÿé•·çš„å½±éŸ¿ã€‚ä»¥ä¸‹å“ªé …çµ„åˆæ­£ç¢ºè­˜åˆ¥ç¤¦ç‰©è³ª X å’Œ Yï¼Ÿ",
          options: [
            "A. ç¤¦ç‰©è³ª Xï¼šæ°®ï¼›ç¤¦ç‰©è³ª Yï¼šéµ",
            "B. ç¤¦ç‰©è³ª Xï¼šéµï¼›ç¤¦ç‰©è³ª Yï¼šæ°®",
            "C. ç¤¦ç‰©è³ª Xï¼šéµï¼›ç¤¦ç‰©è³ª Yï¼šç£·",
            "D. ç¤¦ç‰©è³ª Xï¼šç£·ï¼›ç¤¦ç‰©è³ª Yï¼šéˆ£"
          ],
          answer: "C",
          image: "img_q4_seedlings.png",
          explanation: ""
        },
        {
          id: 5,
          question:
            "ä¸Šè¿°å¹¼è‹—å¯¦é©—ä¸­ï¼Œç”¨é‹ç®”åŒ…è£¹å®¹å™¨çš„ä¸»è¦ç›®çš„æ˜¯ç”šéº¼ï¼Ÿ",
          options: [
            "A. ä¿æŒåŸ¹é¤Šæ¶²çš„æº«åº¦æ†å®š",
            "B. é˜²æ­¢åŸ¹é¤Šæ¶²ä¸­çš„ç¤¦ç‰©è³ªåˆ†è§£",
            "C. é˜²æ­¢æ ¹éƒ¨å‡ºç¾å‘å…‰æ€§åæ‡‰",
            "D. é˜²æ­¢è—»é¡åœ¨åŸ¹é¤Šæ¶²ä¸­ç”Ÿé•·"
          ],
          answer: "D",
          image: "img_q4_seedlings.png",
          explanation: ""
        },
        {
          id: 6,
          question:
            "æŸæµ®è‘‰çš„æ©«åˆ‡é¢ä¸­ï¼ŒPã€Qã€M ç­‰ç´°èƒè¢«æ¨™ç¤ºã€‚å“ªé …çµ„åˆæ­£ç¢ºé…å°å„ç´°èƒåŠå…¶åŠŸèƒ½ï¼Ÿ",
          options: [
            "A. è£½é€ é£Ÿç‰©ï¼šPï¼›è½‰é‹æ°´ï¼šQï¼›èª¿ç¯€æ°´åˆ†æµå¤±ï¼šM",
            "B. è£½é€ é£Ÿç‰©ï¼šPï¼›è½‰é‹æ°´ï¼šRï¼›èª¿ç¯€æ°´åˆ†æµå¤±ï¼šM",
            "C. è£½é€ é£Ÿç‰©ï¼šOï¼›è½‰é‹æ°´ï¼šQï¼›èª¿ç¯€æ°´åˆ†æµå¤±ï¼šN",
            "D. è£½é€ é£Ÿç‰©ï¼šOï¼›è½‰é‹æ°´ï¼šRï¼›èª¿ç¯€æ°´åˆ†æµå¤±ï¼šN"
          ],
          answer: "A",
          image: "img_q6_leaf.png",
          explanation: ""
        },
        {
          id: 7,
          question:
            "æ°´åˆ†ç”±ç´°èƒ N æµå¤±è‡³ç´°èƒé–“éš™ Xï¼Œç„¶å¾Œç¶“æ§‹é€  Y æµå¤±è‡³è‘‰ç‰‡å¤–ã€‚ä¸‹åˆ—å“ªé …çµ„åˆæ­£ç¢ºæŒ‡å‡ºæ°´åˆ†ç§»å‹•æ‰€æ¶‰åŠçš„éç¨‹ï¼Ÿ",
          options: [
            "A. N â†’ Xï¼šæ“´æ•£ï¼›ç¶“ Yï¼šè’¸é¨°",
            "B. N â†’ Xï¼šè’¸ç™¼ï¼›ç¶“ Yï¼šæ“´æ•£",
            "C. N â†’ Xï¼šæ»²é€ï¼›ç¶“ Yï¼šè’¸ç™¼",
            "D. N â†’ Xï¼šè’¸é¨°ï¼›ç¶“ Yï¼šæ»²é€"
          ],
          answer: "B",
          image: "img_q6_leaf.png",
          explanation: ""
        },
        {
          id: 8,
          question: "ä¸‹åˆ—å“ªé …ä¸æœƒæå‡æ°´åˆ†ç¶“ç”±æ§‹é€  Y æµå¤±çš„é€Ÿç‡ï¼Ÿ",
          options: [
            "A. ç©ºæ°£æ¿•åº¦ä¸Šå‡",
            "B. å…‰å¼·åº¦å¢åŠ ",
            "C. é¢¨é€Ÿå¢åŠ ",
            "D. æº«åº¦ä¸Šå‡"
          ],
          answer: "A",
          image: "img_q6_leaf.png",
          explanation: ""
        },
        {
          id: 9,
          question: "è–°è¡£è‰å¯ä»¥è—‰æ’æç¹æ®–ã€‚é€™ç¨®ç¹æ®–æ–¹æ³•å±¬ç„¡æ€§ç”Ÿæ®–ï¼Œå› ç‚ºï¼š",
          options: [
            "A. éç¨‹æ˜¯äººå·¥çš„",
            "B. éç¨‹ä¸­åªæ¶‰åŠä¸€å€‹è¦ªæœ¬",
            "C. éç¨‹ä¸­æ²’æœ‰æ¶‰åŠç´°èƒåˆ†è£‚",
            "D. éç¨‹ä¸­æ²’æœ‰æ¶‰åŠé…å­çš„èåˆ"
          ],
          answer: "D",
          explanation: ""
        },
        {
          id: 10,
          question:
            "ä¸‹åˆ—å“ªäº›æœ‰é—œäºŒåˆ†è£‚çš„æ•è¿°æ˜¯æ­£ç¢ºçš„ï¼Ÿ\n(1) äºŒåˆ†è£‚æ˜¯ç‡Ÿé¤Šç¹æ®–çš„ä¸€ç¨®å½¢å¼ã€‚\n(2) äºŒåˆ†è£‚æ˜¯ç„¡æ€§ç”Ÿæ®–çš„ä¸€ç¨®å½¢å¼ã€‚\n(3) ä¸€å€‹è¦ªæœ¬ç´°èƒæ¯æ¬¡åˆ†è£‚æœƒç”¢ç”Ÿå…©å€‹å­ç´°èƒã€‚",
          options: [
            "A. åªæœ‰ (1) å’Œ (2)",
            "B. åªæœ‰ (1) å’Œ (3)",
            "C. åªæœ‰ (2) å’Œ (3)",
            "D. (1)ã€(2) å’Œ (3)"
          ],
          answer: "C",
          explanation: ""
        },
        {
          id: 11,
          question: "ä¸‹åˆ—å“ªé …ä¸æœƒåœ¨ç´°èƒé€±æœŸçš„é–“æœŸä¸­ç™¼ç”Ÿï¼Ÿ",
          options: [
            "A. ç´°èƒå…§ DNA çš„åˆ†é‡å¢åŠ ä¸€å€",
            "B. ç´°èƒå…§ç·šç²’é«”çš„æ•¸é‡å¢åŠ ",
            "C. ç´°èƒå…§æŸ“è‰²é«”çš„æ•¸é‡å¢åŠ ä¸€å€",
            "D. ç´°èƒçš„é«”ç©å¢å¤§"
          ],
          answer: "C",
          explanation: ""
        },
        {
          id: 12,
          question:
            "ä¸‹åˆ—å“ªäº›äº‹æƒ…åªåœ¨æ¸›æ•¸ç´°èƒåˆ†è£‚æ™‚ç™¼ç”Ÿï¼Œè€Œä¸æœƒåœ¨æœ‰çµ²ç´°èƒåˆ†è£‚æ™‚ç™¼ç”Ÿï¼Ÿ\n(1) DNA çš„åˆ†é‡å¢åŠ ä¸€å€\n(2) åŒæºæŸ“è‰²é«”åˆ†é›¢\n(3) åŒæºæŸ“è‰²é«”ä¸­çš„éå§Šå¦¹æŸ“è‰²å–®é«”å½¢æˆäº¤å‰",
          options: [
            "A. åªæœ‰ (1) å’Œ (2)",
            "B. åªæœ‰ (1) å’Œ (3)",
            "C. åªæœ‰ (2) å’Œ (3)",
            "D. (1)ã€(2) å’Œ (3)"
          ],
          answer: "C",
          explanation: ""
        },
        {
          id: 13,
          question:
            "å…‰å¼·åº¦ç”± 0 å¢åŠ è‡³æŸæ•¸å€¼æ™‚ï¼Œæ¤ç‰©ç”±é‡‹æ”¾äºŒæ°§åŒ–ç¢³è½‰ç‚ºæ·¨å¸æ”¶äºŒæ°§åŒ–ç¢³ã€‚æ­¤å…‰å¼·åº¦ç¨±ç‚ºè£œå„Ÿé»ã€‚ä»¥ä¸‹å“ªå€‹å…‰å¼·åº¦æœ€æ¥è¿‘è£œå„Ÿé»ï¼Ÿ",
          options: [
            "A. 0 å€‹ä»»æ„å–®ä½",
            "B. 40 å€‹ä»»æ„å–®ä½",
            "C. 300 å€‹ä»»æ„å–®ä½",
            "D. 500 å€‹ä»»æ„å–®ä½"
          ],
          answer: "B",
          image: "img_q13_light.png",
          explanation: ""
        },
        {
          id: 14,
          question: "åœ¨è£œå„Ÿé»ï¼Œæ¤ç‰©æ²’æœ‰äºŒæ°§åŒ–ç¢³çš„æ·¨å¸å…¥å’Œæ·¨é‡‹å‡ºï¼ŒåŸå› æ˜¯ï¼š",
          options: [
            "A. å…‰åˆä½œç”¨é€Ÿç‡è¼ƒå‘¼å¸ä½œç”¨é€Ÿç‡é«˜",
            "B. å…‰åˆä½œç”¨é€Ÿç‡èˆ‡å‘¼å¸ä½œç”¨é€Ÿç‡ç›¸ç­‰",
            "C. å…‰åˆä½œç”¨é€Ÿç‡è¼ƒå‘¼å¸ä½œç”¨é€Ÿç‡ä½",
            "D. äºŒæ°§åŒ–ç¢³æ¿ƒåº¦é™åˆ¶äº†å…‰åˆä½œç”¨é€Ÿç‡"
          ],
          answer: "B",
          image: "img_q13_light.png",
          explanation: ""
        }
      ];

      // ========= ç‹€æ…‹è®Šæ•¸ =========
      let shuffledIndices = [];
      let currentIndex = 0;
      let score = 0;
      let wrongQuestionIds = [];
      let hasSubmittedCurrent = false;

      // DOM
      const progressText = document.getElementById("progress-text");
      const scoreText = document.getElementById("score-text");
      const questionImage = document.getElementById("question-image");
      const questionText = document.getElementById("question-text");
      const optionsContainer = document.getElementById("options-container");
      const feedbackEl = document.getElementById("feedback");
      const explanationEl = document.getElementById("explanation");
      const submitBtn = document.getElementById("submit-btn");
      const nextBtn = document.getElementById("next-btn");
      const restartBtn = document.getElementById("restart-btn");
      const summaryCard = document.getElementById("summary-card");
      const summaryMain = document.getElementById("summary-main");
      const summaryPercent = document.getElementById("summary-percent");
      const wrongListEl = document.getElementById("wrong-list");

      // ========= å·¥å…·å‡½å¼ =========
      function shuffleQuestions() {
        shuffledIndices = questionBank.map(function (_, index) {
          return index;
        });
        for (let i = shuffledIndices.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          const tmp = shuffledIndices[i];
          shuffledIndices[i] = shuffledIndices[j];
          shuffledIndices[j] = tmp;
        }
      }

      function updateStatusBar() {
        const total = questionBank.length;
        progressText.textContent =
          "ç¬¬ " + (currentIndex + 1) + " é¡Œï¼å…± " + total + " é¡Œ";
        scoreText.textContent = "ç›®å‰å¾—åˆ†ï¼š" + score + "ï¼" + total + " é¡Œ";
      }

      function clearFeedback() {
        feedbackEl.textContent = "";
        feedbackEl.classList.remove("correct", "incorrect");
        explanationEl.style.display = "none";
        explanationEl.textContent = "";
      }

      function loadQuestion() {
        if (!questionBank.length) {
          questionText.textContent =
            "ç›®å‰é¡Œåº«ç‚ºç©ºï¼Œè«‹å…ˆåœ¨ç¨‹å¼ç¢¼ä¸­åŠ å…¥é¡Œç›®ã€‚";
          optionsContainer.innerHTML = "";
          submitBtn.disabled = true;
          nextBtn.disabled = true;
          return;
        }

        clearFeedback();
        hasSubmittedCurrent = false;
        submitBtn.disabled = true;
        nextBtn.disabled = true;

        const qIndex = shuffledIndices[currentIndex];
        const q = questionBank[qIndex];

        // é¡¯ç¤ºé¡Œç›®åœ–ç‰‡ï¼ˆå¦‚æœ‰ï¼‰
        if (q.image) {
          questionImage.style.display = "block";
          questionImage.innerHTML =
            '<img src="' + q.image + '" alt="é¡Œç›®åœ–åƒ">';
        } else {
          questionImage.style.display = "none";
          questionImage.innerHTML = "";
        }

        // é¡Œç›®æ–‡å­—
        questionText.textContent = q.question;

        // é¸é …
        optionsContainer.innerHTML = "";
        for (let i = 0; i < q.options.length; i++) {
          const letter = String.fromCharCode(65 + i); // 'A', 'B', ...
          const li = document.createElement("li");
          li.className = "option-item";

          const label = document.createElement("label");
          label.className = "option-label";

          const input = document.createElement("input");
          input.type = "radio";
          input.name = "option";
          input.value = letter;

          const span = document.createElement("span");
          span.textContent = q.options[i];

          label.appendChild(input);
          label.appendChild(span);
          li.appendChild(label);
          optionsContainer.appendChild(li);
        }

        const radios = document.querySelectorAll('input[name="option"]');
        radios.forEach(function (r) {
          r.addEventListener("change", function () {
            submitBtn.disabled = false;
          });
        });

        updateStatusBar();
      }

      // ========= ä½œç­”èˆ‡è©•åˆ† =========
      function handleSubmit() {
        if (hasSubmittedCurrent) return;

        const selected = document.querySelector('input[name="option"]:checked');
        if (!selected) {
          alert("è«‹å…ˆé¸æ“‡ä¸€å€‹é¸é …å†æäº¤ã€‚");
          return;
        }

        const userAnswer = selected.value;
        const qIndex = shuffledIndices[currentIndex];
        const q = questionBank[qIndex];

        hasSubmittedCurrent = true;

        const labels = document.querySelectorAll(".option-label");
        labels.forEach(function (label) {
          const input = label.querySelector("input");
          if (!input) return;
          input.disabled = true;
          if (input.value === q.answer) {
            label.classList.add("correct");
          }
          if (input.value === userAnswer && userAnswer !== q.answer) {
            label.classList.add("incorrect");
          }
        });

        if (userAnswer === q.answer) {
          score++;
          feedbackEl.textContent = "âœ… ç­”å°äº†ï¼";
          feedbackEl.classList.add("correct");
        } else {
          feedbackEl.textContent = "âŒ ç­”éŒ¯äº†ã€‚æ­£ç¢ºç­”æ¡ˆæ˜¯ " + q.answer + "ã€‚";
          feedbackEl.classList.add("incorrect");
          wrongQuestionIds.push(q.id);
        }

        if (q.explanation && q.explanation.trim() !== "") {
          explanationEl.style.display = "block";
          explanationEl.textContent = "è§£é‡‹ï¼š" + q.explanation;
        }

        updateStatusBar();

        if (currentIndex === questionBank.length - 1) {
          nextBtn.textContent = "æŸ¥çœ‹çµæœ âœ";
        } else {
          nextBtn.textContent = "ä¸‹ä¸€é¡Œ âœ";
        }
        nextBtn.disabled = false;
        submitBtn.disabled = true;
      }

      function showSummary() {
        const total = questionBank.length;
        const percent = total ? Math.round((score / total) * 100) : 0;

        summaryMain.textContent = "ç¸½åˆ†ï¼šç­”å° " + score + "ï¼" + total + " é¡Œ";
        summaryPercent.textContent = "æ­£ç¢ºç‡ï¼šç´„ " + percent + " %";

        if (!wrongQuestionIds.length) {
          wrongListEl.innerHTML =
            '<span class="tag">ğŸ’¯</span>æ­å–œä½ ï¼Œå…¨éƒ¨é¡Œç›®éƒ½ç­”å°äº†ï¼æ²’æœ‰éŒ¯é¡Œã€‚';
        } else {
          const uniqueWrong = Array.from(new Set(wrongQuestionIds));
          wrongListEl.innerHTML =
            '<span class="tag">â— éŒ¯é¡Œ</span>ä½ åšéŒ¯çš„é¡Œç›®ç·¨è™Ÿç‚ºï¼š' +
            uniqueWrong.join("ã€");
        }

        summaryCard.style.display = "block";
      }

      function handleNext() {
        if (!hasSubmittedCurrent) return;

        if (currentIndex < questionBank.length - 1) {
          currentIndex++;
          loadQuestion();
        } else {
          showSummary();
        }
      }

      function restartQuiz() {
        score = 0;
        wrongQuestionIds = [];
        currentIndex = 0;
        hasSubmittedCurrent = false;
        summaryCard.style.display = "none";
        shuffleQuestions();
        loadQuestion();
      }

      // ========= äº‹ä»¶ç¶å®š & åˆå§‹åŒ– =========
      submitBtn.addEventListener("click", handleSubmit);
      nextBtn.addEventListener("click", handleNext);
      restartBtn.addEventListener("click", restartQuiz);

      (function init() {
        shuffleQuestions();
        loadQuestion();
      })();
    </script>
  </body>
</html>
